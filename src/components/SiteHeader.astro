---
import { Icon } from "astro-icon/components"
import bsm from "@/content/data/bsm.json"
import { data } from "@/content/data/navigasi.json"
import { basename } from "@/utils/text"

// Logo gelap
const LogoGelapBasename = basename(bsm.logo.gelap)
const { default: LogoGelap } = await import(`../assets/${LogoGelapBasename}.svg`)

// Cek halaman beranda
const isHome = Astro.url.pathname === "/"

// Cek halaman aktif
const isActive = (href: string) => {
  const path = Astro.url.pathname
  if (href === "/") return path === "/"
  return path.startsWith(href)
}
---

<header
  class:list={[
    "site-header",
    isHome ? "fixed w-full" : "sticky",
    "top-0 z-10 bg-white/90 backdrop-blur-xs border-b border-b-gray-200 shadow-sm transition-colors",
  ]}
>
  <div class="container flex items-center py-2">
    <a href="/" aria-label={`Logo ${bsm.label}`}
      ><LogoGelap height="1em" width="1em" class="text-5xl" /></a
    >

    <input id="nav-toggle" type="checkbox" class="peer hidden" />

    <label
      for="nav-toggle"
      class:list={[
        "ml-auto",
        "flex",
        "items-center",
        "border",
        "border-gray-200",
        "transition-colors",
        "peer-checked:border-blue-500",
        "peer-checked:bg-blue-500",
        "peer-checked:text-white",
        "md:hidden",
      ]}
      aria-label="Klik untuk membuka atau menutup menu navigasi"
    >
      <Icon name="bi:list" size="3rem" class="in-peer-checked:hidden" />
      <Icon name="bi:x-lg" size="3rem" class="hidden in-peer-checked:block" />
    </label>

    <nav
      class:list={[
        "invisible",
        "absolute",
        "top-[125%]",
        "right-4",
        "left-4",
        "bg-blue-500",
        "opacity-0",
        "shadow-md",
        "transition-all",
        "peer-checked:visible",
        "peer-checked:top-full",
        "peer-checked:opacity-100",
        "md:visible",
        "md:static",
        "md:ml-auto",
        "md:flex",
        "md:items-center",
        "md:gap-x-1",
        "md:bg-transparent",
        "md:opacity-100",
        "md:shadow-none",
      ]}
    >
      {
        data.map(({ label, href }) => (
          <a
            href={href}
            class:list={[
              href === Astro.url.pathname ? "active" : "",
              "block",
              "px-5 py-3",
              "not-first:border-t",
              "border-blue-400",
              "text-right",
              "text-gray-100",
              "font-medium",
              "hover:text-white",
              "[&.active]:text-white",
              "transition-colors",
              "md:not-first:border-t-0",
              "md:px-3 md:py-1",
              "md:text-left",
              "md:text-gray-700",
              "md:text-shadow-black/10",
              "md:hover:bg-blue-500",
              "md:hover:text-shadow-md",
              "md:[&.active]:bg-blue-500",
              "md:[&.active]:text-shadow-md",
            ]}
          >
            {label}
          </a>
        ))
      }
    </nav>
  </div>
</header>
