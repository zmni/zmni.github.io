---
import { slugify } from "@/utils/text"

type Props = {
  label: string
  key: string
  options: string[]
  selected?: string
  isNav?: boolean
}

const { label, key, options, selected = "", isNav = false } = Astro.props

// Determine onchange behavior for navigation selects
// const onChangeAttr = customOnChange
//   ? customOnChange
//   : isNav && navBaseUrl
//     ? `if(this.value) window.location.href='${navBaseUrl}' + this.value + '/'`
//     : undefined
const onChangeAttr = isNav
  ? "if(this.value) window.location.href='/produk/area/' + this.value + '/'; else window.location.href='/produk/'"
  : undefined
---

<li class="relative flex items-center gap-x-2" data-role="filter-group" data-filter-group={key}>
  <label for={`filter-${key}`} class="font-bold">{label}</label>

  <select
    id={`filter-${key}`}
    name={key}
    class="border-2 border-gray-200 bg-white px-2 py-1.5 transition-colors hover:border-blue-500 focus:outline-blue-500"
    data-group={!isNav ? key : undefined}
    aria-label={`Filter berdasarkan ${label}`}
    onchange={onChangeAttr}
  >
    <option value="" selected={selected === "" || selected === undefined}>Semua</option>
    {
      options.map(value => {
        // slugify 'value' untuk URL navigasi
        const optionValue = isNav ? slugify(value) : value
        const isSelected = isNav ? slugify(selected) === optionValue : selected === value

        return (
          <option value={optionValue} selected={isSelected}>
            {value}
          </option>
        )
      })
    }
  </select>
</li>
